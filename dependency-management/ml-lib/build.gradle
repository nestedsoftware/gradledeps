/*
 * This file was generated by the Gradle 'init' task.
 *
 * This generated file contains a sample Java library project to get you started.
 * For more details take a look at the 'Building Java & JVM projects' chapter in the Gradle
 * User Manual available at https://docs.gradle.org/6.7.1/userguide/building_java_projects.html
 */

plugins {
    id 'java-library'
    id 'maven-publish'
}

sourceSets {
    vlad {

    }
}

version = "0.0.1"

repositories {
    mavenCentral()
    mavenLocal()
}

task printVlad {
    doLast {
        println "*** $sourceSets.vlad.runtimeClasspath.asPath"
        println "*** $tasks.compileVladJava.classpath"
        println "*** $sourceSets.main.runtimeClasspath.asPath"
    }
}

configurations {
    fatJar {
        canBeConsumed = true
        canBeResolved = false
    }
}

dependencies {
    // Use JUnit test framework.
    testImplementation 'junit:junit:4.13'
//    implementation 'com.matrixstuff.matrixlib:matrixlib:1.0.0'
    vladImplementation 'com.matrixstuff.matrixlib:matrixlib:1.0.0'
    implementation project(":matrixlib")
}

task customFatJar(type: Jar) {
    archiveBaseName = 'all-in-one-jar'
    dependsOn configurations.runtimeClasspath, configurations.compileClasspath
    from { configurations.runtimeClasspath.collect { it.isDirectory() ? it : zipTree(it) } }
    with jar
}

artifacts {
    fatJar(customFatJar)
}

task printStuff {
    doLast {
        configurations.runtimeElements.getAllDependencies().each {
            println "**** $it.group:$it.name:$it.version"
        }

        configurations.runtimeElements.getAllArtifacts().each {
            println "**** $it.file"
        }

    }
}

publishing {
    publications {
        maven(MavenPublication) {
            groupId 'com.mathstuff.mathlib'
            artifactId 'mathlib'
            version '0.0.1'

            from components.java
        }
    }
}

